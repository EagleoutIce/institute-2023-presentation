\lstdefinelanguage{lFancyTex}{
morecomment = [l]{\%},
keywordstyle = [5]\sol@style@get{command}, % for commands, in this case, as we dont have literals
add to literate={\\$}{{\$}}1 {\\$}{{\$}}1 {\\\%}{{\%}}1 {\\}{{{{\textcolor{gray}{\textbackslash}}}}}1,
alsoletter={\\\#@*},
moredelim=**[is][{\solhlboxd{\solcustom}}]{|custom|}{|custom|},
moredelim=[is][]{|plain|}{|plain|},
columns=[c]flexible,
escapeinside={!*}{*!},
morekeywords = [2]{},
morekeywords = [5]{},
morekeywords = [3]{},
morekeywords = [4]{},
morekeywords = [6]{},
morekeywords = [7]{\#1,\#2,\#3,\#4,\#5,\#6,\#7,\#8,\#9},
alsoother={!,"_^},
}

\RegisterLanguage{latex}{lFancyTex}